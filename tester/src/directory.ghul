namespace IO is
    use System;
    use Generic;

    class DIRECTORY: Object, Iterable[String] is
        files: Iterable[String];

        Iterator: Generic.Iterator[String] => files.Iterator;

        init(path: String) is
            let dir = native.opendir(path.toCString());

            if dir == null then
                throw new Exception("blah");
                // FileStream.throwIOError("directory", path, FileStream.StaticLastError);
            fi

            let results = new Vector[String]();

            do
                let ent = native.readdir(dir);

                if ent == null then
                    break;
                fi

                results.add(new String(cast char ptr(native.__get_dirent_name(ent))));
            od

            files = results;
        si
    si
si
