namespace Test is
    use System.Object;
    use System.Console;

    class Main is
        entry() static is
            @IL.entrypoint()
            
            test(new Base());
            test(new NOT_DERIVED());
            test(new DERIVED_BASE());
            test(new DERIVED_TRAIT());
            test(new DERIVED_BASE_AND_TRAIT());
            test(new MORE_DERIVED());

            return;
        si

        test(b: Object) static is
            Console.write_line("" + b + " isa Trait: " + isa Trait(b));
    
            if isa Trait(b) then
                cast Trait(b).do_trait();
            fi
            
    
            Console.write_line("" + b + " isa Base: " + isa Base(b));
    
            if isa Base(b) then
                cast Base(b).do_base();
            fi        
        si
    si

    trait Trait is
        do_trait();        
    si

    class Base is
        init() is          
        si
        
        do_base() is
            Console.write_line("" + self + " do_base()");
        si
        
    si

    class NOT_DERIVED is
        init() is            
        si
    si

    class DERIVED_BASE: Base is
        init() is            
        si
    si

    class DERIVED_TRAIT: Trait is
        init() is            
        si

        do_trait() is
            Console.write_line("" + self + " do_trait()");
        si
    si

    class DERIVED_BASE_AND_TRAIT: Base, Trait is
        init() is            
        si

        do_trait() is
            Console.write_line("" + self + " do_trait()");
        si
    si

    class MORE_DERIVED: DERIVED_BASE_AND_TRAIT is
        init() is            
        si
        
    si    
si