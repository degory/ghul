namespace IR is
    use Generic;
    use System;

    class TEMP is
        _context: IR.CONTEXT;

        id: int;
        suffix: int;
        type: Semantic.Type.BASE;

        name: String is
            if suffix > 0 then
                return "'.temp." + id + "." + suffix + "'";
            else
                return "'.temp." + id + "'";                                
            fi            
        si

        init(context: IR.CONTEXT, id: int, type: Semantic.Type.BASE) is
            init(context, id, 0, type);
        si

        init(context: IR.CONTEXT, id: int, suffix: int, type: Semantic.Type.BASE) is
            self._context = context;
            self.suffix = suffix;

            self.id = id;
            self.type = type;

            declare();
        si

        init(context: IR.CONTEXT, id: int, value: Semantic.Graph.Value.BASE) is
            init(context, id, 0, value);
        si

        init(context: IR.CONTEXT, id: int, suffix: int, value: Semantic.Graph.Value.BASE) is
            init(context, id, suffix, value.type);

            store(value);
        si

        declare() is            
            _context.write_line(".locals init (" + type.il_type_name + " " + name + ")");
        si

        load() -> Semantic.Graph.Value.Load.TEMP => new Semantic.Graph.Value.Load.TEMP(name, type);

        store(value: Semantic.Graph.Value.BASE) is
            Semantic.Graph.Value.BASE.gen(value, _context);

            _context.write_line("stloc " + name);
        si        
    si
si