namespace Shim is
    use System.String;

    use System.StringBuffer;
    use System.Text.StringBuilder;
    
    use Collections.Iterable;

    class JOIN[T] is
        _values: Iterable[T];
        _delimiter: String;

        init(values: Iterable[T]) is
            _values = values;
            _delimiter = ",";
        si

        @IF.legacy()
        toString() -> String is
            let seen_any = false;

            let result = new StringBuffer();

            for value in _values do
                if seen_any then
                    result.append(_delimiter);
                fi

                result.append(value);

                seen_any = true;
            od

            return result;
        si
        
        @IF.dotnet()
        @IL.name("ToString")
        to_string() -> String is
            let seen_any = false;

            let result = new StringBuilder();

            for value in _values do
                if seen_any then
                    result.append(_delimiter);
                fi

                result.append(value);

                seen_any = true;
            od
            
            return result.to_string();
        si
    si
si