namespace Syntax.Process is
    use Tree;

    class EXPAND_NAMESPACES: Visitor  is
        init() is
            super.init();
        si

        apply(node: NODE) is
            node.walk(self);
        si

        visit(namespace_: Definition.NAMESPACE) is
            var names = namespace_.name.parent_names;

            if names.Length > 0 then
                namespace_.name = new Identifier.NODE(namespace_.name.location, namespace_.name.name);
                var body = namespace_.body;
                var current = namespace_;
                
                for n in names do
                    current.body = new Definition.LIST(current.location, [new Definition.NAMESPACE(current.location, current.name, current.body)]: Definition.NODE );
                    current.name = new Identifier.NODE(namespace_.name.location, n);
                od
            fi
        si
    si
si
