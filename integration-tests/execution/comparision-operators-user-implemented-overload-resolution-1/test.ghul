namespace Test is
    use IO.Std.write_line;

    // instance method:
    class I is
        value: int;

        init(v: int) is value = v; si

        =~(other: I) -> bool => value == other.value; // equals/not-equals
        <>(other: I) -> int => value - other.value; // inequalities

        =~(other: object) -> bool is assert false else "wrong overload called"; si // equals/not-equals
        <>(other: object) -> int is assert false else "wrong overload called"; si // inequalities

        =~(a: I, b: I) -> bool static is assert false else "wrong overload called"; si // equals/not-equals
        <>(a: I, b: I) -> int static is assert false else "wrong overload called"; si // inequalities
    si

    =~(a: I, b: I) -> bool is assert false else "wrong overload called"; si // equals/not-equals
    <>(a: I, b: I) -> int  is assert false else "wrong overload called"; si // inequalities

    check(a: object, b: object, operator: string, expected: bool, actual: bool) is
        write_line("{0} {1} {2} result {3} (expected {4} vs actual {5})", [a, operator, b, expected == actual, expected, actual]);
    si
    
    entry() is
        let i_123 = new I(123);
        let j_123 = new I(123);
        let k_456 = new I(456);
        let l_100 = new I(100);

        check(i_123, i_123, "=~", true, i_123 =~ i_123);
        check(i_123, j_123, "=~", true, i_123 =~ j_123);
        check(i_123, k_456, "=~", false, i_123 =~ k_456);

        check(i_123, i_123, "!~", false, i_123 !~ i_123);
        check(i_123, j_123, "!~", false, i_123 !~ j_123);
        check(i_123, k_456, "!~", true, i_123 !~ k_456);

        check(i_123, i_123, ">", false, i_123 > i_123);
        check(i_123, j_123, ">", false, i_123 > j_123);
        check(i_123, k_456, ">", false, i_123 > k_456);
        check(i_123, l_100, ">", true, i_123 > l_100);

        check(i_123, i_123, ">=", true, i_123 >= i_123);
        check(i_123, j_123, ">=", true, i_123 >= j_123);
        check(i_123, k_456, ">=", false, i_123 >= k_456);
        check(i_123, l_100, ">=", true, i_123 >= l_100);

        check(i_123, i_123, "<", false, i_123 < i_123);
        check(i_123, j_123, "<", false, i_123 < j_123);
        check(i_123, k_456, "<", true, i_123 < k_456);
        check(i_123, l_100, "<", false, i_123 < l_100);

        check(i_123, i_123, "<=", true, i_123 <= i_123);
        check(i_123, j_123, "<=", true, i_123 <= j_123);
        check(i_123, k_456, "<=", true, i_123 <= k_456);
        check(i_123, l_100, "<=", false, i_123 <= l_100);
    si
si
