namespace Test is
    use IO.Std.write_line;

    // instance method:
    class Base is
        value: int;

        init(v: int) is value = v; si

        ##(other: Base) -> string => "Base.##(Base)";
        ##(other: object) -> string => "Base.##(object)";
    si

    class Derived: Base is
        init(v: int) is super.init(v); si

        =~(other: Derived) -> bool => value == other.value; // equals/not-equals
        <>(other: Derived) -> int => value - other.value; // inequalities        
    si    

    ##(a: Base, b: Base) -> bool is assert false else "wrong overload called"; si // equals/not-equals
    <>(a: Base, b: Base) -> int  is assert false else "wrong overload called"; si // inequalities

    check(a: object, b: object, operator: string, expected: bool, actual: bool) is
        write_line("{0} {1} {2} result {3} (expected {4} vs actual {5})", [a, operator, b, expected == actual, expected, actual]);
    si
    
    entry() is
        let i_123 = new Derived(123);
        let j_123 = new Derived(123);
        let k_456 = new Base(456);
        let l_100 = new Derived(100);

        check(i_123, i_123, "=~", true, i_123 =~ i_123);
        check(i_123, j_123, "=~", true, i_123 =~ j_123);
        check(i_123, k_456, "=~", false, i_123 =~ k_456);

        check(i_123, i_123, "!~", false, i_123 !~ i_123);
        check(i_123, j_123, "!~", false, i_123 !~ j_123);
        check(i_123, k_456, "!~", true, i_123 !~ k_456);

        check(i_123, i_123, ">", false, i_123 > i_123);
        check(i_123, j_123, ">", false, i_123 > j_123);
        check(i_123, k_456, ">", false, i_123 > k_456);
        check(i_123, l_100, ">", true, i_123 > l_100);

        check(i_123, i_123, ">=", true, i_123 >= i_123);
        check(i_123, j_123, ">=", true, i_123 >= j_123);
        check(i_123, k_456, ">=", false, i_123 >= k_456);
        check(i_123, l_100, ">=", true, i_123 >= l_100);

        check(i_123, i_123, "<", false, i_123 < i_123);
        check(i_123, j_123, "<", false, i_123 < j_123);
        check(i_123, k_456, "<", true, i_123 < k_456);
        check(i_123, l_100, "<", false, i_123 < l_100);

        check(i_123, i_123, "<=", true, i_123 <= i_123);
        check(i_123, j_123, "<=", true, i_123 <= j_123);
        check(i_123, k_456, "<=", true, i_123 <= k_456);
        check(i_123, l_100, "<=", false, i_123 <= l_100);
    si
si
